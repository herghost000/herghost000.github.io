<!DOCTYPE HTML>
<html lang="zh-CN">

<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="ZackAddy&#39;s Blog - 不积跬步，无以至千里；不积小流，无以成江海">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <meta name="theme-version" content="1.2.3">
    <meta name="root" content="/">
    <link rel="dns-prefetch" href="https://www.zackaddy.xin">
    <!--SEO-->

<meta name="keywords" content="OpenGL">


<meta name="description" content="OpenGL 之GLSL内建变量顶点着色器变量我们已经接触过其中的两个了：顶点着色器的输出向量gl_Position，和片段着色器的gl_FragCoord。    
gl_PointSize我...">


<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->

<title>
    
    66、OpenGL 之GLSL内建变量 |
    
    ZackAddy&#39;s Blog - 不积跬步，无以至千里；不积小流，无以成江海
</title>

<link rel="alternate" href="/atom.xml" title="ZackAddy&#39;s Blog - 不积跬步，无以至千里；不积小流，无以成江海" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    

<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.7.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">
    



    

</head></html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
<canvas id="canvas" style="position: fixed;width: 100%;height: 100%;left: 0;top: 0;"></canvas>
<a href="https://github.com/herghost000"><img style="position: absolute;left: 0;top: 0;z-index: 11" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_left_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    <header class="main-header"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='ZackAddy'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
            <!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
            <h2>
                从未如此简单有趣
            </h2>
            
        </div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                        <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="https://www.zackaddy.xin">
                        ZackAddy&#39;s Blog - 不积跬步，无以至千里；不积小流，无以成江海</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        <li role="presentation" class="text-center">
                            <a href="/"><i class="fa"></i>HOME</a>
                        </li>
                        <li role="presentation" class="text-center">
                            <a href="/categories"><i class="fa"></i>CATEGORIES</a>
                        </li>
                        <li role="presentation" class="text-center">
                            <a href="/archives"><i class="fa"></i>TIMELINE</a>
                        </li>
                        <li role="presentation" class="text-center">
                            <a href="/about"><i class="fa"></i>ABOUT</a>
                        </li>
                    </ul>
<!--                    <div class="menu-title">-->
<!--                        <a href="/"><i class="fa"></i>首页</a>-->
<!--                    </div>-->
<!--                    <div class="menu-title">-->
<!--                        <span>分类</span>-->
<!--                        <ul class="menu">-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/LinearAlgebra/"><i class="fa "></i>-->
<!--                                        LinearAlgebra</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Cocos Creator/"><i class="fa "></i>-->
<!--                                        Cocos Creator</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/OpenGL/"><i class="fa "></i>-->
<!--                                        OpenGL</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/JavaScript/"><i class="fa "></i>-->
<!--                                        JavaScript</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/代码重构/"><i class="fa "></i>-->
<!--                                        代码重构</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/C/"><i class="fa "></i>-->
<!--                                        C</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Cpp/"><i class="fa "></i>-->
<!--                                        C++</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/数据结构/"><i class="fa "></i>-->
<!--                                        数据结构</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Cpp设计模式/"><i class="fa "></i>-->
<!--                                        C++设计模式</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/MFC/"><i class="fa "></i>-->
<!--                                        MFC</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/STL/"><i class="fa "></i>-->
<!--                                        STL</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/COM组件/"><i class="fa "></i>-->
<!--                                        COM组件</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Golang/"><i class="fa "></i>-->
<!--                                        Golang</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Mysql/"><i class="fa "></i>-->
<!--                                        Mysql</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Redis/"><i class="fa "></i>-->
<!--                                        Redis</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Nginx/"><i class="fa "></i>-->
<!--                                        Nginx</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/PHP/"><i class="fa "></i>-->
<!--                                        PHP</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/8086汇编/"><i class="fa "></i>-->
<!--                                        8086汇编</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/x86汇编/"><i class="fa "></i>-->
<!--                                        x86汇编</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Smali汇编/"><i class="fa "></i>-->
<!--                                        Smali汇编</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Lua/"><i class="fa "></i>-->
<!--                                        Lua</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/逆向分析/"><i class="fa "></i>-->
<!--                                        逆向分析</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Windows驱动/"><i class="fa "></i>-->
<!--                                        Windows驱动</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Windows内核/"><i class="fa "></i>-->
<!--                                        Windows内核</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Vue/"><i class="fa "></i>-->
<!--                                        Vue</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/React/"><i class="fa "></i>-->
<!--                                        React</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/Flutter Widget/"><i class="fa "></i>-->
<!--                                        Flutter Widget</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/categories/计算机网络/"><i class="fa "></i>-->
<!--                                        计算机网络</a>-->
<!--                                </li>-->
<!--                            -->
<!--                                <li role="presentation" class="text-center">-->
<!--                                    <a href="/archives/"><i class="fa "></i>-->
<!--                                        时间轴</a>-->
<!--                                </li>-->
<!--                            -->
<!--                        </ul>-->
<!--                    </div>-->
                </div>
            </div>
        </div>
    </div>
</nav>

    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="66、OpenGL 之GLSL内建变量">
            
            66、OpenGL 之GLSL内建变量
            
        </h1>
        <div class="post-meta">
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a class="category-link" href="/categories/OpenGL/">OpenGL</a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            <a class="tag-link" href="/tags/OpenGL/">OpenGL</a>
            
        </span>
    </span>
    
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">
            2020/06/23</span>
    </span>
    
    
</div>
        
        
    </div>
    
    <div class="post-body post-content">
        <h2 id="OpenGL-之GLSL内建变量"><a href="#OpenGL-之GLSL内建变量" class="headerlink" title="OpenGL 之GLSL内建变量"></a><strong>OpenGL 之GLSL内建变量</strong></h2><h3 id="顶点着色器变量"><a href="#顶点着色器变量" class="headerlink" title="顶点着色器变量"></a><strong>顶点着色器变量</strong></h3><p>我们已经接触过其中的两个了：顶点着色器的输出向量gl_Position，和片段着色器的gl_FragCoord。    </p>
<h4 id="gl-PointSize"><a href="#gl-PointSize" class="headerlink" title="gl_PointSize"></a><strong>gl_PointSize</strong></h4><p>我们能够选用的其中一个图元是GL_POINTS，如果使用它的话，每一个顶点都是一个图元，都会被渲染为一个点。我们可以通过OpenGL的glPointSize函数来设置渲染出来的点的大小，但我们也可以在顶点着色器中修改这个值。</p>
<p>GLSL定义了一个叫做gl_PointSize输出变量，它是一个float变量，你可以使用它来设置点的宽高（像素）。在顶点着色器中修改点的大小的话，你就能对每个顶点设置不同的值了。</p>
<p>在顶点着色器中修改点大小的功能默认是禁用的，如果你需要启用它的话，你需要启用OpenGL的GL_PROGRAM_POINT_SIZE：</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glEnable(<span class="name">GL_PROGRAM_POINT_SIZE</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>一个简单的例子就是将点的大小设置为裁剪空间位置的z值，也就是顶点距观察者的距离。点的大小会随着观察者距顶点距离变远而增大。</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">gl_Position</span> = projection * view * model * <span class="type">vec4</span>(aPos, <span class="number">1.0</span>);    </span><br><span class="line">    <span class="built_in">gl_PointSize</span> = <span class="built_in">gl_Position</span>.z;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="gl-VertexID"><a href="#gl-VertexID" class="headerlink" title="gl_VertexID"></a><strong>gl_VertexID</strong></h4><p>gl_Position和gl_PointSize都是输出变量，因为它们的值是作为顶点着色器的输出被读取的。我们可以对它们进行写入，来改变结果。顶点着色器还为我们提供了一个有趣的输入变量，我们只能对它进行读取，它叫做gl_VertexID。</p>
<p>整型变量gl_VertexID储存了正在绘制顶点的当前ID。当（使用glDrawElements）进行索引渲染的时候，这个变量会存储正在绘制顶点的当前索引。当（使用glDrawArrays）不使用索引进行绘制的时候，这个变量会储存从渲染调用开始的已处理顶点数量。</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 420 core</span></span><br><span class="line"><span class="keyword">layout</span> (<span class="keyword">location</span> = <span class="number">0</span>) <span class="keyword">in</span> <span class="type">vec3</span> aPos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> model;</span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> projection;</span><br><span class="line"><span class="keyword">uniform</span> <span class="type">mat4</span> view;</span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> pColor;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()&#123;</span><br><span class="line">	<span class="built_in">gl_Position</span> = projection * view * model * <span class="type">vec4</span>(aPos , <span class="number">1.0</span>f);</span><br><span class="line">	<span class="built_in">gl_PointSize</span> = <span class="built_in">abs</span>(aPos.z) * <span class="number">10</span>;</span><br><span class="line">	pColor = <span class="type">vec4</span>(<span class="built_in">gl_VertexID</span> / <span class="number">12.0</span>f + <span class="number">0.1</span>f , <span class="built_in">gl_VertexID</span> / <span class="number">3.0</span>f + <span class="number">0.1</span>f , <span class="built_in">gl_VertexID</span> / <span class="number">8.0</span>f + <span class="number">0.1</span>f, <span class="number">1.0</span>f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 420 core</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> FragColor;</span><br><span class="line"><span class="keyword">in</span> <span class="type">vec4</span> pColor;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()&#123;</span><br><span class="line">	FragColor = pColor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于顶点 ID 不同，所以亮度不同</p>
<h3 id="片段着色器变量"><a href="#片段着色器变量" class="headerlink" title="片段着色器变量"></a><strong>片段着色器变量</strong></h3><p>在片段着色器中，我们也能访问到一些有趣的变量。GLSL提供给我们两个有趣的输入变量：gl_FragCoord和gl_FrontFacing。</p>
<h4 id="gl-FragCoord"><a href="#gl-FragCoord" class="headerlink" title="gl_FragCoord"></a><strong>gl_FragCoord</strong></h4><p>gl_FragCoord的x和y分量是片段的窗口空间(Window-space)坐标，其原点为窗口的左下角。我们已经使用glViewport设定了一个800x600的窗口了，所以片段窗口空间坐标的x分量将在0到800之间，y分量在0到600之间。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">void</span> main()</span><br><span class="line">&#123;             </span><br><span class="line">    <span class="keyword">if</span>(gl_FragCoord.x &lt; <span class="number">400</span>)</span><br><span class="line">        FragColor = vec4(<span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        FragColor = vec4(<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>);        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为窗口的宽度是800。当一个像素的x坐标小于400时，它一定在窗口的左侧，所以我们给它一个不同的颜色</p>
<p><img src="https://learnopengl-cn.github.io/img/04/08/advanced_glsl_fragcoord.png" alt="image"></p>
<h4 id="gl-FrontFacing"><a href="#gl-FrontFacing" class="headerlink" title="gl_FrontFacing"></a><strong>gl_FrontFacing</strong></h4><p>如果我们不使用面剔除，那么gl_FrontFacing将会告诉我们当前片段是属于正向面的一部分还是背向面的一部分</p>
<p>gl_FrontFacing变量是一个bool，如果当前片段是正向面的一部分那么就是true，否则就是false。比如说，我们可以这样子创建一个立方体，在内部和外部使用不同的纹理：</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 330 core</span></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> FragColor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">in</span> <span class="type">vec2</span> TexCoords;</span><br><span class="line"></span><br><span class="line"><span class="keyword">uniform</span> <span class="type">sampler2D</span> frontTexture;</span><br><span class="line"><span class="keyword">uniform</span> <span class="type">sampler2D</span> backTexture;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;             </span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">gl_FrontFacing</span>)</span><br><span class="line">        FragColor = <span class="built_in">texture</span>(frontTexture, TexCoords);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        FragColor = <span class="built_in">texture</span>(backTexture, TexCoords);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://learnopengl-cn.github.io/img/04/08/advanced_glsl_frontfacing.png" alt="image"></p>
<h4 id="gl-FragDepth"><a href="#gl-FragDepth" class="headerlink" title="gl_FragDepth"></a><strong>gl_FragDepth</strong></h4><p>GLSL提供给我们一个叫做gl_FragDepth的输出变量，我们可以使用它来在着色器内设置片段的深度值。</p>
<p>要想设置深度值，我们直接写入一个0.0到1.0之间的float值到输出变量就可以了：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gl_FragDepth</span> = <span class="number">0.0</span><span class="comment">; // 这个片段现在的深度值为 0.0</span></span><br></pre></td></tr></table></figure>

<p>只要我们在片段着色器中对gl_FragDepth进行写入，OpenGL就会禁用所有的提前深度测试(Early Depth Testing)。</p>
<p>它被禁用的原因是，OpenGL无法在片段着色器运行之前得知片段将拥有的深度值，因为片段着色器可能会完全修改这个深度值。</p>
<p>在写入gl_FragDepth时，你就需要考虑到它所带来的性能影响。然而，从OpenGL 4.2起，我们仍可以对两者进行一定的调和，在片段着色器的顶部使用深度条件(Depth Condition)重新声明gl_FragDepth变量：</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">layout</span> (depth_&lt;condition&gt;) <span class="keyword">out</span> <span class="type">float</span> <span class="built_in">gl_FragDepth</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>条件</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>any</td>
<td>默认值。提前深度测试是禁用的，你会损失很多性能</td>
</tr>
<tr>
<td>greater</td>
<td>你只能让深度值比gl_FragCoord.z更大</td>
</tr>
<tr>
<td>less</td>
<td>你只能让深度值比gl_FragCoord.z更小</td>
</tr>
<tr>
<td>unchanged</td>
<td>如果你要写入gl_FragDepth，你将只能写入gl_FragCoord.z的值</td>
</tr>
</tbody></table>
<p>下面这个例子中，我们对片段的深度值进行了递增，但仍然也保留了一些提前深度测试</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 420 core // 注意GLSL的版本！</span></span><br><span class="line"><span class="keyword">out</span> <span class="type">vec4</span> FragColor;</span><br><span class="line"><span class="keyword">layout</span> (<span class="keyword">depth_greater</span>) <span class="keyword">out</span> <span class="type">float</span> <span class="built_in">gl_FragDepth</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;             </span><br><span class="line">    FragColor = <span class="type">vec4</span>(<span class="number">1.0</span>);</span><br><span class="line">    <span class="built_in">gl_FragDepth</span> = <span class="built_in">gl_FragCoord</span>.z + <span class="number">0.1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>
    
    <div class="post-footer">
        <div>
            
            转载声明：
            商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">罗天</a>
            
            
        </div>
        <div>
            
        </div>
    </div>
</article>
<div class="article-nav prev-next-wrap clearfix">
    
    <a href="/2020/06/23/OpenGL/67、OpenGL 之GLSL接口块/" class="pre-post btn btn-default" title='67、OpenGL 之GLSL接口块'>
        <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
        <span class="hidden-xs">
            67、OpenGL 之GLSL接口块</span>
    </a>
    
    
    <a href="/2020/06/22/OpenGL/65、OpenGL 之高级数据/" class="next-post btn btn-default" title='65、OpenGL 之高级数据'>
        <span class="hidden-lg">下一篇</span>
        <span class="hidden-xs">
            65、OpenGL 之高级数据</span><i class="fa fa-angle-right fa-fw"></i>
    </a>
    
</div>

<div id="comments">
    
<p>评论系统未开启，无法评论！</p>

</div>

                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">
            文章目录
        </h3>
        
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenGL-之GLSL内建变量"><span class="toc-text">OpenGL 之GLSL内建变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#顶点着色器变量"><span class="toc-text">顶点着色器变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gl-PointSize"><span class="toc-text">gl_PointSize</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gl-VertexID"><span class="toc-text">gl_VertexID</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#片段着色器变量"><span class="toc-text">片段着色器变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#gl-FragCoord"><span class="toc-text">gl_FragCoord</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gl-FrontFacing"><span class="toc-text">gl_FrontFacing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gl-FragDepth"><span class="toc-text">gl_FragDepth</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>
                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>
<a id="back-to-top" class="icon-btn hide">
    <i class="fa fa-chevron-up"></i>
</a>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>
            </div>
            <div class="col-sm-12">
                <span>Copyright &copy;
                    2012
                    
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/herghost000" class="copyright-links" target="_blank" rel="nofollow">ZackX</a>
                </span>
            </div>
        </div>
    </div>
</div>


<script src="/assets/tagcanvas.min.js?rev=2.9"></script>
<script>
var tagOption = {
    textColour: '#444', // 字体颜色
    outlineMethod: 'block', // 选中模式
    outlineColour: '#FFDAB9', // 选中模式的颜色
    interval: 30 || 30, // 动画帧之间的时间间隔，值越大，转动幅度越大
    textHeight: 13,
    outlineRadius: 3,
    freezeActive: true || '', // 选中的标签是否继续滚动
    frontSelect: true || '', // 不选标签云后部的标签
    initial: [0.1, -0.1],
    depth: 0.5,
    decel: 0.95,
    maxSpeed: 0.03,
    reverse: true || '', // 是否反向触发
    fadeIn: 500, // 进入动画时间
    wheelZoom: false || '' // 是否启用鼠标滚轮
}
TagCanvas.Start('tag-cloud-3d', '', tagOption);
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/parallax/3.1.0/parallax.min.js"></script>
<script src="/js/app.js?rev=@@hash"></script>



</body>
</html>
